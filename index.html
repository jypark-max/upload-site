<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë°”ì´ë¸Œ ì½”ë”© | ìŠ¤ë§ˆíŠ¸ ë¬¸ì„œ ìˆ˜ì§‘ê¸°</title>
    <style>
        body { font-family: 'Pretendard', sans-serif; background-color: #f4f7f9; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        .upload-card { background: white; padding: 40px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); text-align: center; width: 100%; max-width: 400px; }
        h2 { color: #333; margin-bottom: 20px; }
        input[type="email"], input[type="file"] { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        button { background-color: #007bff; color: white; border: none; padding: 15px 20px; border-radius: 8px; cursor: pointer; width: 100%; font-size: 16px; font-weight: bold; transition: background 0.3s; }
        button:hover { background-color: #0056b3; }
        #status { margin-top: 20px; font-size: 14px; font-weight: 500; }
        .loader { color: #555; }
        .success { color: #28a745; }
        .error { color: #dc3545; }
    </style>
</head>
<body>

    <div class="upload-card">
        <h2>ğŸ“ ë¬¸ì„œ ì—…ë¡œë“œ</h2>
        <p style="color: #666; font-size: 14px;">ì§€ì •ëœ ì´ë©”ì¼ ì‚¬ìš©ìë§Œ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
        
        <input type="email" id="userEmail" placeholder="í—ˆìš©ëœ ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”" required>
        
        <input type="file" id="fileInput">
        
        <button onclick="uploadFile()">êµ¬ê¸€ ë“œë¼ì´ë¸Œë¡œ ì „ì†¡</button>
        
        <div id="status"></div>
    </div>

    <script>
        // âš ï¸ ì£¼ì˜: êµ¬ê¸€ ì•±ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ ë°°í¬ í›„ ë°›ì€ URLì„ ì—¬ê¸°ì— ë„£ìœ¼ì„¸ìš”!
        const GAS_URL = "https://script.google.com/macros/library/d/10yXAlSMB1_JYbVf-VZJuCSkGBZ29n6dJlXL5CCPhe5IZSnay6Zs70xL3/1";

        function uploadFile() {
            const fileInput = document.getElementById('fileInput');
            const emailInput = document.getElementById('userEmail');
            const status = document.getElementById('status');
            
            if (!emailInput.value) { alert("ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."); return; }
            if (fileInput.files.length === 0) { alert("íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”."); return; }

            const file = fileInput.files[0];
            const reader = new FileReader();

            status.innerHTML = '<span class="loader">â³ ì—…ë¡œë“œ ë° ë¶„ì„ ì¤‘...</span>';
            status.className = "";

            reader.onload = function(e) {
                const base64Data = e.target.result.split(',')[1];
                
                const formData = new URLSearchParams();
                formData.append('fileData', base64Data);
                formData.append('filename', file.name);
                formData.append('mimeType', file.type);
                formData.append('userEmail', emailInput.value); // ì´ë©”ì¼ ë°ì´í„° ì¶”ê°€

                fetch(GAS_URL, {
                    method: 'POST',
                    body: formData,
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' }
                })
                .then(res => res.json())
                .then(data => {
                    if(data.result === "success") {
                        status.innerHTML = '<span class="success">âœ… ì™„ë£Œ! ë“œë¼ì´ë¸Œì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.</span>';
                    } else {
                        status.innerHTML = '<span class="error">âŒ ì˜¤ë¥˜: ' + data.error + '</span>';
                    }
                })
                .catch(err => {
                    status.innerHTML = '<span class="error">âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</span>';
                    console.error(err);
                });
            };
            reader.readAsDataURL(file);
        }
    </script>
</body>
</html>
